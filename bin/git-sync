#!/bin/bash

set -x

MASTER_BRANCH="master"
CURRENT_BRANCH="$(git branch --show-current)"
TARGET_BRANCH=${1:-''}
SOURCE_BRANCH=${2:-$MASTER_BRANCH}

if [[ $CURRENT_BRANCH == $MASTER_BRANCH ]]; then
  git pull --no-tags origin $SOURCE_BRANCH
  exit 0
fi

git fetch --no-tags origin $SOURCE_BRANCH:$SOURCE_BRANCH

git rebase origin/$SOURCE_BRANCH $(git branch-grep $TARGET_BRANCH)
